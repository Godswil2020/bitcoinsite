
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Referral - Profit Bit Investment</title>
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        .referral-hero {
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.15) 0%, rgba(26, 26, 26, 0.9) 100%);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            margin-bottom: 40px;
        }

        .hero-title {
            color: #FF8C00;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .hero-subtitle {
            color: #cccccc;
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .referral-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.1) 0%, rgba(26, 26, 26, 0.8) 100%);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #FF8C00;
            box-shadow: 0 10px 30px rgba(255, 140, 0, 0.2);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 15px;
        }

        .stat-value {
            color: #ffffff;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #cccccc;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .referral-link-section {
            background: rgba(26, 26, 26, 0.6);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 140, 0, 0.2);
            margin-bottom: 30px;
        }

        .section-title {
            color: #FF8C00;
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .link-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .referral-link {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 8px;
            color: #ffffff;
            font-family: monospace;
            font-size: 14px;
        }

        .copy-btn {
            background: linear-gradient(45deg, #FF8C00, #FFA500);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 140, 0, 0.3);
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .share-whatsapp { background: #25D366; color: white; }
        .share-telegram { background: #0088cc; color: white; }
        .share-facebook { background: #1877f2; color: white; }
        .share-twitter { background: #1da1f2; color: white; }

        .share-btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        .referral-tiers {
            background: rgba(26, 26, 26, 0.6);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 140, 0, 0.2);
            margin-bottom: 30px;
        }

        .tier-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .tier-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .tier-name {
            color: #FF8C00;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tier-commission {
            color: #ffffff;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .tier-requirement {
            color: #cccccc;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .tier-benefits {
            list-style: none;
            padding: 0;
        }

        .tier-benefits li {
            color: #cccccc;
            font-size: 12px;
            padding: 3px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tier-benefits li::before {
            content: '✓';
            color: #4CAF50;
            font-weight: bold;
        }

        .referral-history {
            background: rgba(26, 26, 26, 0.6);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 140, 0, 0.2);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .history-table th,
        .history-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-table th {
            background: rgba(255, 140, 0, 0.1);
            color: #FF8C00;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .history-table td {
            color: #cccccc;
        }

        .referral-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .status-active { background: rgba(76, 175, 80, 0.2); color: #4CAF50; }
        .status-pending { background: rgba(255, 152, 0, 0.2); color: #FF9800; }

        @media (max-width: 768px) {
            .referral-hero, .referral-link-section, .referral-tiers, .referral-history {
                padding: 25px;
                margin: 20px;
            }

            .link-container {
                flex-direction: column;
            }

            .share-buttons {
                justify-content: center;
            }

            .hero-title {
                font-size: 24px;
            }

            .tier-grid {
                grid-template-columns: 1fr;
            }

            .history-table {
                font-size: 12px;
            }

            .history-table th,
            .history-table td {
                padding: 10px 8px;
            }
        }
        /* Hide dashboard title on mobile */
@media (max-width: 768px) {
  .header h1 {
    display: none;
  }

  /* Style and show the mobile menu toggle */
  .mobile-menu-toggle {
    display: block;
    position: relative;
    margin: 10px 0 15px auto;
    font-size: 28px;
    background: transparent;
    border: none;
    color: orange;
    cursor: pointer;
    padding: 5px 15px;
  }

  /* Mobile menu hidden by default */
  .mobile-menu {
    display: none;
    background-color: #111;
    position: fixed;
    top: 60px;  /* adjust according to your header height */
    left: 0;
    width: 250px;
    height: calc(100vh - 60px);
    overflow-y: auto;
    z-index: 10000;
    padding-top: 20px;
    transition: transform 0.3s ease-in-out;
    box-shadow: 2px 0 12px rgba(0,0,0,0.8);
  }

  /* Show menu when active */
  .mobile-menu.active {
    display: block;
  }

  /* Sidebar menu style inside mobile menu */
  .mobile-menu .sidebar-menu {
    list-style: none;
    padding-left: 0;
    margin: 0;
  }

  .mobile-menu .menu-item {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    color: #fff;
    text-decoration: none;
    border-bottom: 1px solid #222;
  }

  .mobile-menu .menu-item:hover {
    background-color: #222;
  }

  .mobile-menu .icon {
    margin-right: 10px;
    font-size: 18px;
  }
}

/* Hide the mobile menu toggle and menu on desktop */
@media (min-width: 769px) {
  .mobile-menu-toggle,
  .mobile-menu {
    display: none !important;
  }
}

    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                   <img src="../assets/img/logo1.png" alt="Profit Bit Investment" class="logo-img">
                </div>
                <button class="sidebar-toggle" id="sidebarToggle">☰</button>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="../index.html" class="menu-item"><span class="icon">📊</span><span class="text">Dashboard</span></a></li>
                <!-- <li><a href="transaction.html" class="menu-item"><span class="icon">📋</span><span class="text">Transaction History</span></a></li> -->
                <li><a href="live-trade.html" class="menu-item"><span class="icon">📈</span><span class="text">Live Trade</span></a></li>
                <li><a href="deposit.html" class="menu-item"><span class="icon">💰</span><span class="text">Deposit Investment</span></a></li>
                <li><a href="withdrawal.html" class="menu-item"><span class="icon">💳</span><span class="text">Withdrawal Investment</span></a></li>
                <li><a href="top-up.html" class="menu-item"><span class="icon">⬆️</span><span class="text">Top-up Investment</span></a></li>
                <li><a href="profile.html" class="menu-item"><span class="icon">👤</span><span class="text">Profile</span></a></li>
                <li><a href="referral.html" class="menu-item active"><span class="icon">🔗</span><span class="text">Referral</span></a></li>
                <li><a href="support.html" class="menu-item"><span class="icon">💬</span><span class="text">Support</span></a></li>
                <li><a href="logout.html" class="menu-item"><span class="icon">🚪</span><span class="text">Logout</span></a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <h1>Referral Program</h1>
                 <div class="user-info">
            <span id="welcomeText">Welcome, User</span>
            <div class="user-avatar" id="userAvatar">U</div>
            </div>
            <!-- MOBILE MENU TOGGLE BUTTON (visible only on mobile) -->
  <button id="mobileMenuToggle" class="mobile-menu-toggle">☰</button>

  <!-- MOBILE MENU (hidden by default) -->
  <nav id="mobileMenu" class="mobile-menu">
    <ul class="sidebar-menu">
      <li><a href="../index.html" class="menu-item active"><span class="icon">📊</span><span class="text">Dashboard</span></a></li>
      <!-- <li><a href="./transaction.html" class="menu-item"><span class="icon">📋</span><span class="text">Transaction History</span></a></li> -->
      <li><a href="./live-trade.html" class="menu-item"><span class="icon">📈</span><span class="text">Live Trade</span></a></li>
      <li><a href="./deposit.html" class="menu-item"><span class="icon">💰</span><span class="text">Deposit Investment</span></a></li>
      <li><a href="./withdrawal.html" class="menu-item"><span class="icon">💳</span><span class="text">Withdrawal Investment</span></a></li>
      <li><a href="./top-up.html" class="menu-item"><span class="icon">⬆️</span><span class="text">Top-up Investment</span></a></li>
      <li><a href="./profile.html" class="menu-item"><span class="icon">👤</span><span class="text">Profile</span></a></li>
      <li><a href="./referral.html" class="menu-item"><span class="icon">🔗</span><span class="text">Referral</span></a></li>
      <li><a href="./support.html" class="menu-item"><span class="icon">💬</span><span class="text">Support</span></a></li>
      <li><a href="./logout.html" class="menu-item"><span class="icon">🚪</span><span class="text">Logout</span></a></li>
    </ul>
  </nav>
            </header>

            <div class="dashboard-content">
                <!-- Hero Section -->
                <div class="referral-hero">
                    <h1 class="hero-title">Earn While You Share</h1>
                    <p class="hero-subtitle">Invite friends and earn up to 10% commission on every investment they make. Start building your passive income network today!</p>
                </div>

                

                <!-- Referral Link Section -->
                <div class="referral-link-section">
                    <h2 class="section-title">Your Referral Link</h2>
                    <div class="link-container">
                        <input type="text" class="referral-link" id="referralLink" value="" readonly>
                        <button class="copy-btn" onclick="copyReferralLink()">Copy Link</button>
                    </div>
                    
                    
                </div>

                <!-- Referral Tiers -->
                <div class="referral-tiers">
                    <h2 class="section-title">Commission Tiers</h2>
                    <div class="tier-grid">
                        <div class="tier-card">
                            <div class="tier-name">Bronze</div>
                            <div class="tier-commission">5%</div>
                            <div class="tier-requirement">0-10 Referrals</div>
                            <ul class="tier-benefits">
                                <li>5% on all referral investments</li>
                                <li>Monthly bonus reports</li>
                                <li>Email support</li>
                            </ul>
                        </div>
                        <div class="tier-card">
                            <div class="tier-name">Silver</div>
                            <div class="tier-commission">7%</div>
                            <div class="tier-requirement">11-25 Referrals</div>
                            <ul class="tier-benefits">
                                <li>7% on all referral investments</li>
                                <li>Weekly bonus reports</li>
                                <li>Priority support</li>
                                <li>Custom referral materials</li>
                            </ul>
                        </div>
                        <div class="tier-card">
                            <div class="tier-name">Gold</div>
                            <div class="tier-commission">10%</div>
                            <div class="tier-requirement">26+ Referrals</div>
                            <ul class="tier-benefits">
                                <li>10% on all referral investments</li>
                                <li>Daily bonus reports</li>
                                <li>VIP support line</li>
                                <li>Personal account manager</li>
                                <li>Exclusive marketing tools</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Referral History -->
                <!-- <div class="referral-history">
                    <h2 class="section-title">Referral Activity</h2>
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Referred User</th>
                                <th>Date Joined</th>
                                <th>Investment</th>
                                <th>Commission</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Alice Johnson</td>
                                <td>Dec 25, 2024</td>
                                <td>$500.00</td>
                                <td>$25.00</td>
                                <td><span class="referral-status status-active">Active</span></td>
                            </tr>
                            <tr>
                                <td>Bob Wilson</td>
                                <td>Dec 22, 2024</td>
                                <td>$1,000.00</td>
                                <td>$50.00</td>
                                <td><span class="referral-status status-active">Active</span></td>
                            </tr>
                            <tr>
                                <td>Carol Davis</td>
                                <td>Dec 20, 2024</td>
                                <td>$300.00</td>
                                <td>$15.00</td>
                                <td><span class="referral-status status-pending">Pending</span></td>
                            </tr>
                            <tr>
                                <td>David Brown</td>
                                <td>Dec 18, 2024</td>
                                <td>$750.00</td>
                                <td>$37.50</td>
                                <td><span class="referral-status status-active">Active</span></td>
                            </tr>
                            <tr>
                                <td>Emma Garcia</td>
                                <td>Dec 15, 2024</td>
                                <td>$1,200.00</td>
                                <td>$60.00</td>
                                <td><span class="referral-status status-active">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div> -->
            </div>
        </main>
    </div>

    <script src="../assets/js/script.js"></script>
    <!-- <script>
        function copyReferralLink() {
            const referralLink = document.getElementById('referralLink');
            copyToClipboard(referralLink.value);
        }

        function shareOnWhatsApp() {
            const link = document.getElementById('referralLink').value;
            const message = `🚀 Join me on Profit Bit Investment and start earning passive income with cryptocurrency! Use my referral link: ${link}`;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function shareOnTelegram() {
            const link = document.getElementById('referralLink').value;
            const message = `🚀 Join me on Profit Bit Investment and start earning passive income with cryptocurrency! Use my referral link: ${link}`;
            const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(message)}`;
            window.open(telegramUrl, '_blank');
        }

        function shareOnFacebook() {
            const link = document.getElementById('referralLink').value;
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`;
            window.open(facebookUrl, '_blank');
        }

        function shareOnTwitter() {
            const link = document.getElementById('referralLink').value;
            const message = `🚀 Join me on Profit Bit Investment and start earning passive income with cryptocurrency!`;
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&url=${encodeURIComponent(link)}`;
            window.open(twitterUrl, '_blank');
        }

        // Animate stats on page load
        document.addEventListener('DOMContentLoaded', function() {
            const statValues = document.querySelectorAll('.stat-value');
            
            statValues.forEach((stat, index) => {
                const finalValue = stat.textContent;
                stat.textContent = '0';
                
                setTimeout(() => {
                    animateValue(stat, 0, parseFloat(finalValue.replace(/[$,]/g, '')) || parseInt(finalValue), 1000, finalValue.includes('$'));
                }, index * 200);
            });
        });

        function animateValue(element, start, end, duration, isCurrency = false) {
            const startTimestamp = performance.now();
            
            function step(currentTimestamp) {
                const elapsed = currentTimestamp - startTimestamp;
                const progress = Math.min(elapsed / duration, 1);
                
                const current = start + (end - start) * progress;
                
                if (isCurrency) {
                    element.textContent = '$' + Math.floor(current).toLocaleString();
                } else if (element.textContent === 'Bronze') {
                    // Don't animate text values
                    return;
                } else {
                    element.textContent = Math.floor(current);
                }
                
                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    // Set final value
                    if (element.textContent !== 'Bronze') {
                        element.textContent = element.textContent;
                    }
                }
            }
            
            requestAnimationFrame(step);
        }
    </script> -->
    <!-- Firebase Compat Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>

<script>
  // Firebase config (use your existing config)
  const firebaseConfig = {
    apiKey: "AIzaSyDqs938UtvScxCz_p2eANLJuVbTjHZKPoI",
    authDomain: "bitcoin-site-8b190.firebaseapp.com",
    projectId: "bitcoin-site-8b190",
    storageBucket: "bitcoin-site-8b190.appspot.com",
    messagingSenderId: "548765450635",
    appId: "1:548765450635:web:3a21f3fefefb117207ef8e",
    measurementId: "G-CMJPS8XHF2"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Get logged-in user's email from localStorage (from login script)
  const userEmail = localStorage.getItem("userEmail");

  
  const referralInput = document.getElementById("referralLink");

  if (!userEmail) {
    // User not logged in — redirect or show message
    console.warn("User email not found in localStorage.");
    window.location.href = "login.html";
  } else {
    // Fetch user data by email
    db.collection("users")
      .where("email", "==", userEmail)
      .limit(1)
      .get()
      .then(async (snapshot) => {
        if (!snapshot.empty) {
          const userDoc = snapshot.docs[0];
          const userData = userDoc.data();
          const uid = userDoc.id;

          // Show welcome text and avatar initials
          const fullName = userData.name || "User";
          const initials = fullName
            .split(" ")
            .map(word => word[0].toUpperCase())
            .join("")
            .substring(0, 2);
          document.getElementById("welcomeText").textContent = `Welcome, ${fullName}`;
          document.getElementById("userAvatar").textContent = initials;

          // Generate referral link
          const referralURL = `https://profitbitinvestment.com/register.html?ref=${uid}`;
          referralInput.value = referralURL;

          // Check if URL has a 'ref' param (referral)
          const urlParams = new URLSearchParams(window.location.search);
          const referrerId = urlParams.get("ref");

          // Only update referral info if:
          // - ref param exists,
          // - referrerId is not same as current user id,
          // - AND user does not already have 'referredBy' set
          if (referrerId && referrerId !== uid && !userData.referredBy) {
            try {
              // Update current user's 'referredBy'
              await db.collection("users").doc(uid).update({ referredBy: referrerId });

              // Update referrer's stats transactionally
              const referrerRef = db.collection("users").doc(referrerId);
              await db.runTransaction(async (transaction) => {
                const refDoc = await transaction.get(referrerRef);
                if (!refDoc.exists) throw "Referrer not found";
                const data = refDoc.data();
                transaction.update(referrerRef, {
                  totalReferred: (data.totalReferred || 0) + 1,
                  referralBonus: (data.referralBonus || 0) + 10, // example bonus amount
                });
              });

              console.log("Referral info updated successfully.");
            } catch (err) {
              console.error("Error updating referral info:", err);
            }
          }

        } else {
          console.warn("User document not found for email:", userEmail);
        }
      })
      .catch((error) => {
        console.error("Error fetching user by email:", error);
      });
  }

  // Copy referral link function (no change)
  function copyReferralLink() {
    const referralLink = document.getElementById("referralLink");
    navigator.clipboard.writeText(referralLink.value)
      .then(() => alert("Referral link copied!"))
      .catch(() => alert("Failed to copy, please copy manually."));
  }

  // Mobile menu toggle (keep your existing)
  const mobileMenuToggle = document.getElementById('mobileMenuToggle');
  const mobileMenu = document.getElementById('mobileMenu');
  mobileMenuToggle.addEventListener('click', () => {
    mobileMenu.classList.toggle('active');
  });


</script>
</body>
</html>
